/*
 * ============================================================================
 *
 *       Filename:  test-average.c
 *
 *    Description:  A testing module to test the the outcome of the 
 *                  compareSequence function defined in '../../src/sequence.c'
 *                  agianst a known predefined array
 *
 *        Version:  1.0
 *        Created:  04-06-2014 13:24:09
 *       Compiler:  gcc
 *
 *         Author:  Jorian van Oostenbrugge
 *
 * ============================================================================
 */

#include <stdio.h>
#include <limits.h>
#include "../../src/sequence.h"
#include "../minunit.h"

// Global variables
int tests_run = 0;
int compare;
int wrongEnd;
int shift;
int compareBlackArray;

// Define tests
// Test full average
static char * testCompare()
{
    mu_assert("error, comparing sequences return wrong number", compare == 100);
    return 0;
}

// Test wrong end
static char * testWrongEnd()
{
    mu_assert("error, the wrong end should return INT_MAX", wrongEnd == INT_MAX);
    return 0;
}

// Test shifting of sequence to fit array
static char * testShift()
{
    mu_assert("error, the shifting isn't working a it should", shift == 110);
    return 0;
}

// Test shifting of sequence to fit array
static char * testBlack()
{
    mu_assert("error, the black array isn't working a it should", compareBlackArray == 500);
    return 0;
}

// All tests
static char * all_tests()
{
    mu_run_test(testCompare);
    mu_run_test(testWrongEnd);
    mu_run_test(testShift);
    mu_run_test(testBlack);
    return 0;
}

int
main(void)
{
    // Array's for testing
    int array[400]={203,198,201,198,200,197,198,197,202,197,201,196,198,197,
                    202,199,201,199,198,196,200,199,202,197,202,195,198,197,
                    202,199,202,199,201,198,199,198,199,197,202,197,199,196,
                    201,196,198,200,202,199,203,198,200,199,200,198,199,198,
                    202,197,201,197,202,198,200,198,201,198,200,199,202,198,
                    200,198,201,200,201,197,201,198,200,198,201,199,200,197,
                    201,197,199,197,202,198,202,197,203,199,201,196,203,199,
                    201,195,201,197,200,199,199,196,200,197,203,197,199,198,
                    201,198,201,197,200,198,197,196,201,197,201,197,200,199,
                    201,196,203,197,199,200,200,196,200,199,203,198,200,198,
                    202,199,201,197,200,198,202,199,201,198,199,197,202,199,
                    199,197,202,198,202,198,199,196,200,199,200,198,200,197,
                    202,197,200,198,200,198,199,198,203,197,200,197,200,197,
                    202,198,200,196,201,200,201,200,201,199,201,197,199,198,
                    202,197,200,197,202,197,202,198,199,198,200,198,199,197,
                    203,197,203,197,198,197,202,197,200,196,199,197,201,195,
                    201,198,202,197,201,196,200,197,200,198,202,199,199,198,
                    201,196,199,197,202,199,203,199,200,198,201,198,203,197,
                    200,198,199,197,199,198,202,198,200,198,199,199,201,198,
                    200,197,200,197,199,196,202,199,199,199,200,196,198,198,
                    201,197,202,196,200,198,202,199,203,197,197,199,201,197,
                    200,199,201,196,199,198};
    
    // This array contains data from 1400544000251742413 the black trace
    int array_black[1934] = {208,238,312,427,519,539,524,489,449,413,
                    386,365,357,347,328,317,299,285,274,279,271,258,251,243,
                    239,245,238,237,228,223,218,217,214,214,214,214,211,216,
                    214,214,211,213,212,211,205,209,204,208,209,216,213,214,
                    208,208,208,207,204,209,205,207,202,203,204,215,218,217,
                    212,215,208,206,206,205,201,203,201,204,201,202,199,200,
                    198,203,199,203,202,203,200,203,198,205,199,203,197,202,
                    199,202,199,204,199,203,203,206,203,203,207,218,215,212,
                    207,211,205,205,202,202,200,203,200,201,200,205,199,202,
                    199,201,200,200,200,202,199,203,200,197,200,202,201,201,
                    200,203,199,201,199,201,199,198,200,204,199,202,199,201,
                    200,201,198,201,200,201,198,204,199,198,197,199,196,199,
                    198,201,197,203,198,200,197,202,197,198,198,198,197,201,
                    197,198,198,200,196,199,199,200,196,198,198,200,196,201,
                    195,200,197,200,198,197,197,201,197,199,197,199,195,199,
                    197,199,197,200,198,203,197,199,198,203,197,201,197,200,
                    198,201,195,198,195,199,196,202,199,198,199,201,198,201,
                    199,200,198,199,198,200,199,199,195,202,197,199,197,201,
                    196,201,199,201,197,197,197,200,195,201,197,200,200,201,
                    211,232,236,232,222,221,209,209,202,206,201,204,201,202,
                    200,201,197,200,198,200,199,202,197,201,198,202,197,201,
                    199,202,198,202,199,201,199,201,198,201,197,200,198,199,
                    197,202,197,203,199,199,198,201,197,199,198,201,197,203,
                    197,202,198,201,198,199,198,200,198,203,198,201,197,199,
                    196,200,197,200,198,201,197,199,196,199,198,203,198,200,
                    198,199,199,201,196,200,197,198,199,202,196,201,199,203,
                    198,201,197,198,199,201,198,201,198,199,197,203,197,200,
                    199,202,202,206,201,204,200,200,199,203,197,201,200,204,
                    199,201,198,201,198,203,197,201,198,200,197,203,198,201,
                    198,200,197,198,197,202,197,201,196,198,197,202,199,201,
                    199,198,196,200,199,202,197,202,195,198,197,202,199,202,
                    199,201,198,199,198,199,197,202,197,199,196,201,196,198,
                    200,202,199,203,198,200,199,200,198,199,198,202,197,201,
                    197,202,198,200,198,201,198,200,199,202,198,200,198,201,
                    200,201,197,201,198,200,198,201,199,200,197,201,197,199,
                    197,202,198,202,197,203,199,201,196,203,199,201,195,201,
                    197,200,199,199,196,200,197,203,197,199,198,201,198,201,
                    197,200,198,197,196,201,197,201,197,200,199,201,196,203,
                    197,199,200,200,196,200,199,203,198,200,198,202,199,201,
                    197,200,198,202,199,201,198,199,197,202,199,199,197,202,
                    198,202,198,199,196,200,199,200,198,200,197,202,197,200,
                    198,200,198,199,198,203,197,200,197,200,197,202,198,200,
                    196,201,200,201,200,201,199,201,197,199,198,202,197,200,
                    197,202,197,202,198,199,198,200,198,199,197,203,197,203,
                    197,198,197,202,197,200,196,199,197,201,195,201,198,202,
                    197,201,196,200,197,200,198,202,199,199,198,201,196,199,
                    197,202,199,203,199,200,198,201,198,203,197,200,198,199,
                    197,199,198,202,198,200,198,199,199,201,198,200,197,200,
                    197,199,196,202,199,199,199,200,196,198,198,201,197,202,
                    196,200,198,202,199,203,197,197,199,201,197,200,199,201,
                    196,199,198,200,199,203,202,201,199,200,198,198,198,200,
                    199,199,197,201,198,200,199,200,198,200,198,202,197,199,
                    198,199,198,201,197,200,199,203,196,199,199,200,197,199,
                    196,200,198,199,198,201,197,201,199,202,196,200,196,203,
                    197,199,198,203,199,201,199,201,197,202,197,200,198,201,
                    197,201,199,201,196,200,198,200,201,202,197,201,199,202,
                    200,202,195,199,200,200,198,201,197,199,198,202,197,202,
                    198,200,197,201,199,201,198,202,197,199,197,199,196,201,
                    197,202,199,201,198,201,197,201,197,201,198,199,198,199,
                    195,200,196,202,199,199,197,199,199,202,198,200,197,201,
                    197,199,197,201,197,201,196,199,198,201,199,204,199,201,
                    199,199,198,199,198,200,196,201,197,203,199,201,197,199,
                    198,202,196,204,198,198,201,201,196,198,197,200,199,201,
                    200,199,197,200,198,201,198,197,198,203,197,200,198,201,
                    198,198,197,201,198,196,198,199,198,201,198,202,194,201,
                    197,199,197,197,200,201,199,203,199,201,198,201,196,203,
                    200,200,197,198,198,200,198,200,199,200,197,200,197,198,
                    198,200,198,202,199,199,200,200,197,199,198,200,198,203,
                    199,201,200,200,197,200,199,201,200,203,197,198,198,200,
                    198,200,196,200,197,202,195,200,198,200,199,200,199,202,
                    199,202,197,199,197,200,199,199,199,200,198,200,199,201,
                    198,198,199,202,198,201,196,200,197,201,199,202,197,202,
                    198,202,197,201,199,200,197,202,197,199,200,203,197,201,
                    197,201,199,203,197,201,198,201,199,202,197,203,198,201,
                    196,201,197,201,198,200,198,200,198,200,199,201,199,200,
                    196,201,197,201,200,200,198,200,199,200,199,201,197,201,
                    197,201,196,202,197,202,198,201,198,201,198,201,198,201,
                    197,201,197,199,199,200,197,201,197,199,198,198,197,199,
                    197,200,200,199,195,200,198,200,198,203,199,201,197,200,
                    197,201,200,201,199,202,197,198,200,202,196,197,198,200,
                    198,200,198,200,200,200,198,201,197,200,199,202,198,203,
                    199,201,196,200,200,199,198,200,198,200,198,200,199,202,
                    197,203,199,201,197,201,199,202,199,199,197,202,199,200,
                    198,201,199,203,198,200,200,200,197,202,197,201,198,201,
                    198,200,197,202,198,203,198,202,200,201,198,200,199,200,
                    196,200,199,200,198,202,198,199,197,200,198,200,198,201,
                    199,202,199,201,199,200,199,203,197,201,196,202,197,201,
                    198,200,198,201,197,201,196,200,198,201,196,202,199,200,
                    198,202,199,201,197,202,199,201,198,199,200,200,198,203,
                    198,201,199,202,201,200,198,201,197,201,196,201,199,201,
                    200,202,199,200,199,201,198,201,200,201,198,199,198,201,
                    199,202,198,199,199,202,200,201,199,202,199,202,198,201,
                    200,201,199,202,197,202,198,201,199,200,199,201,198,201,
                    199,201,199,200,198,202,199,201,199,201,197,199,200,202,
                    198,202,200,201,198,203,200,200,198,201,198,199,199,200,
                    198,203,199,203,199,201,197,200,199,204,197,204,198,199,
                    200,202,198,201,200,201,201,203,199,199,200,201,198,202,
                    199,200,197,202,199,201,199,201,197,200,199,203,198,200,
                    199,200,199,203,198,201,198,201,198,203,199,200,199,200,
                    199,202,198,202,199,202,198,203,198,199,198,200,197,200,
                    200,201,199,203,197,202,198,199,200,201,197,201,199,203,
                    200,202,198,202,199,203,198,203,197,201,200,193,199,202,
                    200,206,197,203,200,202,201,202,199,202,198,201,199,201,
                    198,202,199,204,199,201,200,200,197,203,199,200,198,202,
                    199,200,200,202,199,203,198,201,200,201,197,203,198,201,
                    198,201,200,202,200,203,199,200,200,201,198,201,200,202,
                    196,198,198,200,198,200,197,204,198,201,198,202,198,201,
                    199,200,199,203,197,200,198,202,198,201,198,203,199,203,
                    198,199,200,203,199,200,200,202,199,201,198,201,198,203,
                    197,199,200,202,199,201,197,201,197,201,199,199,199,202,
                    198,200,197,202,198,201,199,203,198,205,198,201,198,201,
                    199,202,196,200,198,202,199,200,199,202,198,201,198,200,
                    197,201,200,201,199,202,199,202,198,201,198,201,197,201,
                    199,201,198,200,198,201,198,200,198,202,199,200,198,202,
                    198,201,199,202,198,201,199,203,199,203,198,200,198,202,
                    200,202,196,202,197,201,197,202,197,202,199,200,198,203,
                    201,201,196,201,199,200,198,200,198,201,199,202,197,200,
                    197,200,198,200,198,201,198,201,200,203,199,201,198,202,
                    199,201,198,201,200,200,198,200,199,202,199,201,198,202,
                    200,201,198,202,198,203,198,201,199,201,197,201,199,201,
                    199,203,197,199,201,202,199,202,197,201,199,200,198,201,
                    199,201,197,201,198,202,198,203,196,202,200,201,199,199,
                    198,203,198,202,198,201,198,200,199,202,197,202,199,199,
                    199,202,198,201,198,201,199,202,199,201,199,200,201,199,
                    200,198,199,203,197,203,200,199,198,201,198,201,199,201,
                    197,203,197,200,198,202,197,201,200,200,199,201,198,202,
                    198,202,197,202,199,203,200,204,197,201,199,202,196,201,
                    197,204,199,203,198,203,198,200,200,200,197,202,198,203,
                    197,199,200,202,199,200,199,202,198,199,199,202,199,201,
                    196,199,197,200,198,201,197,200,198,201,196,199,199,202,
                    198,203,198,201,198,199,200,203,197,203,197,201,199,201,
                    200,203,198,203,199,201,198,201,197,201,199,202,199,200,
                    198,201,199,202,198,200,195,200,198,199,199,199,199,202,
                    198,201,197,201,200,202,195,203,199,201,199,203,197,202,
                    198,201,199,202,198,200,199,200,197,202,198,200,198,201,
                    199,203,198,203,197,201,197,200,199,201,198,200,201,202,
                    200,200,198,199,197,202,199,200,200,198,200,203,197,201,
                    198,202,197,204,198,201,199,201,199,200,197,203,196,202,
                    197,200,198,198,198,199};
    
    // Compare two sequences until the end of the array is reached
    compare = compareSequences(0, 100, array, 300, 100);
    
    // Set the end on purpose much to high
    wrongEnd = compareSequences(0, 400, array, 300, 400);
    
    // Set width to such a number that we need to shift the end
    shift = compareSequences(0, 110, array, 300, 110);
    
    // Check the sequences for the array_black
    compareBlackArray = compareSequences(0, 100, array_black, 1934, 100);
    
    // Run tests
    char *result = all_tests();
    if (result != 0)
    {
        printf("%s\n", result);
    }
    else
    {
        printf("ALL TESTS PASSED\n");
    }
    
    printf("Tests run: %d\n", tests_run);
    return result != 0;
}


