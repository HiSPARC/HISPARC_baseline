from ctypes import *
from sys import exit

# Define the structure
class TVARIABLES(Structure):
    _fields_ = [("numberOfPeaks", c_int16), 
                ("leftCutOff", c_int16), 
                ("rightCutOff", c_int16),
                ("pulseHeight", c_int16),
                ("pulseIntegral", c_int32)]

# Create instance of variables class
blah = TVARIABLES()              
              
# Make sure we can use the function from baseline.dll
baseline_dll = CDLL("../../../project/Baseline/Release/Baseline.dll")
trace_Variables = baseline_dll.traceVariables

trace = [195,207,195,204,196,206,196,203,194,207,195,206,196,204,195,206,193,205,195,205,195,206,196,204,197,206,196,205,195,205,196,206,195,204,195,203,194,205,192,208,194,203,195,205,195,204,198,205,196,204,196,202,195,205,195,205,195,203,195,205,198,202,196,204,195,203,196,203,196,206,196,205,194,204,196,205,195,204,196,205,196,206,195,203,196,205,196,205,194,205,196,205,196,204,196,206,195,205,194,203,196,205,196,207,196,202,193,205,195,202,197,204,196,202,195,203,194,204,196,205,195,205,194,205,195,202,195,202,196,206,196,203,194,203,197,205,195,202,195,204,195,204,194,202,194,203,195,204,195,204,195,204,195,202,195,203,194,204,195,206,193,203,196,203,196,205,192,203,198,206,195,203,196,204,196,205,194,205,195,203,196,204,195,204,195,204,194,202,197,206,196,203,196,204,195,203,192,203,196,205,194,204,194,204,195,206,194,203,198,205,194,204,197,204,196,204,196,204,195,204,197,204,194,205,196,203,195,205,198,205,194,203,196,204,196,204,195,204,194,205,194,204,194,204,197,205,193,207,196,205,196,205,195,203,193,205,196,205,195,206,195,206,195,203,196,205,195,205,196,203,196,204,196,204,195,209,195,203,195,206,196,205,196,205,193,204,197,206,196,206,197,205,196,205,195,206,195,203,195,207,196,204,195,206,197,203,195,201,198,207,195,205,195,204,195,207,194,203,195,205,195,205,194,205,195,206,196,205,194,204,195,205,197,205,196,205,194,206,195,206,196,204,195,205,196,204,194,206,194,205,196,204,195,203,195,203,196,205,195,208,196,206,195,206,195,204,195,205,195,205,196,205,195,205,195,203,194,205,197,207,197,206,194,205,197,206,196,203,195,207,195,206,195,206,196,204,195,202,198,207,200,220,270,424,627,979,1371,1750,2033,2251,2379,2468,2504,2520,2515,2522,2509,2491,2443,2414,2398,2443,2466,2468,2424,2382,2314,2279,2228,2189,2133,2081,1984,1905,1778,1660,1516,1396,1225,1123,1009,931,848,832,773,753,703,673,625,613,582,589,552,553,511,506,459,449,406,413,389,424,418,439,409,409,370,367,334,349,320,325,296,304,275,286,266,290,287,313,305,329,300,304,282,292,263,285,277,301,283,292,261,272,252,270,252,273,258,281,276,308,307,354,348,361,328,324,285,294,265,273,246,263,252,265,246,267,247,269,255,276,253,269,253,267,243,253,236,263,250,270,251,268,245,262,252,275,262,280,258,271,244,255,235,246,229,248,232,250,232,246,223,238,221,241,220,234,214,227,205,223,206,222,201,213,195,213,199,214,192,207,194,212,201,217,194,207,189,206,189,205,188,203,182,198,181,202,185,194,179,196,178,192,172,191,174,189,171,191,174,189,177,193,179,195,182,196,184,196,179,192,175,193,184,204,186,200,184,209,191,202,189,206,189,198,179,193,177,193,173,196,184,209,194,211,189,203,181,193,175,189,171,187,174,190,171,187,172,189,171,190,172,188,174,193,181,200,184,204,202,220,196,209,186,195,176,191,175,188,173,191,179,200,189,198,184,203,192,207,187,206,188,202,182,193,177,192,173,190,172,187,173,191,179,195,179,196,189,212,196,207,188,199,178,193,181,198,184,199,179,195,178,191,176,191,173,188,176,196,186,203,185,199,188,203,186,195,182,205,201,217,201,214,195,209,195,213,198,208,188,201,187,204,186,200,181,197,191,209,198,209,189,199,183,191,178,190,177,193,175,188,174,189,173,191,174,191,179,195,180,193,177,192,175,192,181,203,189,199,183,195,181,191,176,190,176,193,181,195,180,194,179,192,178,191,174,189,175,192,176,188,175,190,178,194,178,190,175,189,175,190,175,189,175,189,174,190,174,189,176,190,175,193,177,193,177,195,182,195,179,191,176,193,185,197,184,202,190,202,186,195,185,203,184,196,179,192,177,191,177,192,175,192,177,190,177,190,177,195,187,199,186,203,190,203,192,204,198,215,197,207,186,195,181,193,178,192,178,190,181,197,188,204,193,203,185,197,182,201,196,208,193,202,185,197,181,195,181,190,179,192,178,192,189,200,189,198,186,195,179,193,179,192,177,191,180,193,177,195,188,207,198,208,194,199,187,195,182,193,182,193,189,204,189,199,185,195,180,193,180,193,181,193,180,191,179,190,182,198,191,201,190,201,182,196,182,191,183,196,184,195,179,192,182,195,178,194,183,193,180,191,180,191,180,193,179,189,178,192,182,191,178,192,182,191,180,192,184,195,185,194,183,194,183,192,182,191,181,195,181,190,179,192,180,188,180,193,181,188,179,191,182,195,181,195,180,192,183,194,180,191,181,192,180,191,181,189,183,190,183,194,179,191,182,196,191,202,190,198,188,193,184,193,183,191,181,192,181,193,184,195,180,193,182,195,182,196,201,214,205,211,197,203,190,199,189,197,184,193,185,193,184,192,184,199,189,199,190,197,186,195,185,194,183,191,184,194,183,194,182,192,185,194,183,194,183,191,182,195,181,193,182,194,183,193,182,194,183,194,182,195,187,199,195,207,192,203,192,201,193,199,189,197,188,197,186,198,196,221,209,213,199,207,193,202,188,196,193,211,210,214,200,207,194,199,188,197,186,196,186,195,184,194,184,195,185,194,184,197,185,194,186,196,186,195,184,193,186,194,182,193,184,196,187,194,185,191,184,194,186,195,182,193,186,195,184,195,183,195,183,196,185,194,186,196,183,195,184,194,185,193,186,194,186,198,182,193,184,194,186,196,196,212,205,211,197,203,192,198,189,198,185,195,185,196,185,195,185,195,185,197,187,200,191,199,191,198,186,197,186,195,186,196,185,196,185,196,185,197,186,195,187,194,187,198,186,194,186,196,186,194,186,197,186,193,187,194,186,197,187,195,187,196,187,194,185,195,187,195,187,194,186,195,187,196,187,204,199,208,194,203,191,199,189,197,186,196,188,198,188,196,186,197,185,197,189,206,201,208,195,203,190,198,188,197,188,195,187,198,188,196,186,196,189,196,186,198,189,195,185,196,188,195,186,199,196,209,199,206,191,199,187,200,188,197,186,197,188,197,187,195,189,195,185,198,188,197,188,201,196,203,193,199,188,198,189,200,189,197,187,196,188,197,188,199,187,194,187,198,188,197,188,198,187,197,189,195,190,206,204,209,197,203,194,201,190,199,189,200,189,198,189,198,189,196,189,194,189,197,188,195,188,198,188,198,188,195,188,197,188,195,189,197,189,200,198,208,196,206,193,202,190,198,189,199,187,198,189,198,188,196,189,197,189,198,189,201,190,197,192,197,188,197,189,199,188,197,190,197,187,198,189,199,188,199,188,196,188,198,190,196,187,198,190,199,189,198,188,198,190,199,191,200,190,200,190,196,189,198,188,197,191,197,188,199,187,197,192,201,195,209,197,203,195,201,192,198,192,200,190,197,192,197,190,199,191,196,190,199,191,197,190,199,191,197,190,197,189,199,189,198,191,199,187,198,188,199,188,199,191,199,190,196,188,199,189,197,191,198,192,198,189,198,190,199,193,204,194,204,195,200,191,199,191,199,190,199,191,197,191,197,190,200,198,216,213,217,203,210,198,206,196,204,192,203,191,199,192,201,189,200,190,202,189,199,190,199,191,203,190,197,189,199,191,198,190,200,192,200,189,200,192,199,191,201,190,199,191,201,190,200,190,200,192,199,190,201,190,202,191,200,192,199,191,198,190,199,191,199,190,197,191,201,191,201,193,199,192,199,194,199,191,198,192,203,189,197,192,200,190,199,190,200,192,200,189,199,193,203,190,199,191,199,191,202,191,199,191,201,189,199,192,200,191,198,191,199,192,203,191,198,193,199,191,198,192,200,190,202,191,198,190,201,193,199,190,201,191,200,191,200,193,202,191,199,193,198,193,199,192,200,191,199,193,197,193,202,193,200,192,199,192,201,193,201,194,199,192,201,192,201,191,199,191,200,190,199,192,199,192,199,191,200,191,200,188,201,192,201,190,199,191,201,192,202,192,202,192,200,193,200,191,199,193,200,192,200,193,200,191,200,191,201,192,201,193,202,192,200,193,200,191,201,194,202,194,199,193,203,193,206,204,213,199,206,194,203,192,203,195,198,192,202,192,203,191,200,194,201,192,197,194,199,193,199,192,200,193,202,192,201,191,200,195,202,198,203,196,202,191,202,194,201,192,202,194,203,196,203,194,199,193,202,193,199,191,201,192,200,194,202,193,200,194,201,192,198,193,201,194,199,193,200,194,201,192,202,193,201,191,198,193,202,194,200,192,201,194,202,193,200,195,200,191,200,194,202,194,202,193,200,192,203,193,199,194,197,195,203,190,202,194,198,193,202,196,199,193,205,193,201,192,201,195,202,193,201,192,200,193,202,193,203,191,203,192,201,192,201,194,202,192,202,194,204,194,201,191,202,192,201,194,200,192,200,194,202,193,202,191,201,192,202,192,199,193,201,195,202,193,201,190,203,193,203,194,202,193,203,191,200,193,202,194,201,194,200,195,201,192,202,191,202,192,203,192,201,193,203,193,202,193,202,192,202,192,201,193,201,193,202,191,203,194,202,189,202,194,202,193,200,193,203,194,202,191,202,194,200,191,203,194,201,193,202,194,202,192,204,192,201,192,202,192,201,192,201,193,202,192,202,194,203,193,202,192,200,194,203,193,201,194,202,194,202,193,203,193,203,191,203,194,200,192,204,194,201,193,201,191,200,192,203,194,203,192,203,192,200,194,205,193,201,193,199,190,200,193,202,194,203,193,204,193,202,193,200,192,201,194,202,192,202,194,200,193,202,193,207,200,207,198,206,196,203,195,203,194,203,194,201,194,203,192,203,192,204,192,205,191,203,193,204,194,202,193,202,194,202,193,204,191,202,194,202,192,202,191,202,191,202,193,203,191,203,193,204,194,204,195,204,194,204,196,205,197,211,201,206,198,205,195,205,192,204,194,203,192,203,195,203,193,203,194,202,190,203,192,202,193,203,193,203,193,204,192,203,194,203,191,201,193,203,192,202,193,204,193,203,192,205,193,203,193,203,193,202,194,205,193,205,195,201,191,203,194,203,194,202,194,203,192,200,195,203,194,202,194,204,193,201,192,201,192,204,192,203,192,204,194,203,193,204,194,205,193,204,194,203,192,203,193,204,193,203,192,203,193,204,191,201,193,203,193,202,192,201,195,204,193,200,192,203,191,203,193,200,193,203,194,200,192,204,194,202,193,202,193,205,193,205,193,203,194,204,194,200,191,203,192,203,194,203,192,205,191,202,194,202,193,200,195,201,193,203,194,200,193,203,193,204,191,203,192,204,192,204,194,203,192,202,192,202,192,203,193,203,192,204,193,202,192,202,194,202,192,201,193,203,194,203,195,202,192,203,192,201,193,204,193,199,193,203,192,203,194,202,194,203,193,202,192,205,193,203,194,203,195,204]

# Define array
trace_array = (c_uint16 * len(trace))(*trace)
            
# Define function prototype as used in dll
trace_Variables.argtypes = [c_uint16 * len(trace_array), c_int16, c_uint32, c_uint16, c_int16, POINTER(TVARIABLES)]
trace_Variables.restype = c_int32
            
# Run the DLL
dll_return = trace_Variables(trace_array, 52, len(trace), 25, 198, byref(blah))

# Show the output
print ("dll = ", dll_return)
print("height = ", blah.pulseHeight)
print("# pulses = ", blah.numberOfPeaks)
print("integral = ", blah.pulseIntegral)